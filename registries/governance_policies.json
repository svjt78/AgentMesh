{
  "version": "1.0.0",
  "last_updated": "2025-12-22T10:00:00Z",
  "_comment": "Governance limits can be overridden by environment variables: MAX_TOOL_INVOCATIONS_PER_SESSION, MAX_LLM_CALLS_PER_SESSION, etc. See config.py for all configurable parameters.",
  "policies": {
    "agent_invocation_access": {
      "description": "Defines which agents the orchestrator is permitted to invoke",
      "enforcement_level": "strict",
      "rules": [
        {
          "agent_id": "orchestrator_agent",
          "allowed_agents": [
            "intake_agent",
            "coverage_agent",
            "fraud_agent",
            "severity_agent",
            "recommendation_agent",
            "explainability_agent"
          ],
          "denied_agents": ["orchestrator_agent"]
        }
      ]
    },
    "agent_tool_access": {
      "description": "Defines which tools each agent is permitted to request",
      "enforcement_level": "strict",
      "rules": [
        {
          "agent_id": "intake_agent",
          "allowed_tools": ["schema_validator"],
          "denied_tools": ["fraud_rules", "similarity", "policy_snapshot", "coverage_rules", "decision_rules"]
        },
        {
          "agent_id": "coverage_agent",
          "allowed_tools": ["policy_snapshot", "coverage_rules"],
          "denied_tools": ["fraud_rules", "similarity", "decision_rules"]
        },
        {
          "agent_id": "fraud_agent",
          "allowed_tools": ["fraud_rules", "similarity"],
          "denied_tools": ["policy_snapshot", "decision_rules", "coverage_rules"]
        },
        {
          "agent_id": "severity_agent",
          "allowed_tools": [],
          "denied_tools": ["fraud_rules", "policy_snapshot", "similarity", "decision_rules", "coverage_rules"]
        },
        {
          "agent_id": "recommendation_agent",
          "allowed_tools": ["decision_rules"],
          "denied_tools": ["fraud_rules", "policy_snapshot", "similarity", "coverage_rules"]
        },
        {
          "agent_id": "explainability_agent",
          "allowed_tools": [],
          "denied_tools": ["*"]
        }
      ]
    },
    "model_usage": {
      "description": "Controls which model profiles agents may use",
      "enforcement_level": "strict",
      "rules": [
        {
          "workflow_id": "claims_triage",
          "allowed_profiles": ["default_gpt35"],
          "default_profile": "default_gpt35"
        }
      ]
    },
    "iteration_limits": {
      "description": "Maximum ReAct iterations per agent to prevent runaway loops. Can be overridden by AGENT_DEFAULT_MAX_ITERATIONS, ORCHESTRATOR_MAX_ITERATIONS env vars.",
      "enforcement_level": "strict",
      "global_max_iterations": 5,
      "agent_overrides": [
        {
          "agent_id": "orchestrator_agent",
          "max_iterations": 10,
          "_comment": "Orchestrator needs more iterations as it coordinates multiple agents"
        },
        {
          "agent_id": "fraud_agent",
          "max_iterations": 5
        },
        {
          "agent_id": "intake_agent",
          "max_iterations": 3
        },
        {
          "agent_id": "explainability_agent",
          "max_iterations": 2
        }
      ]
    },
    "execution_constraints": {
      "description": "Global execution limits",
      "enforcement_level": "strict",
      "max_workflow_duration_seconds": 300,
      "max_tool_invocations_per_session": 50,
      "max_llm_calls_per_session": 30
    },
    "hitl_access_control": {
      "description": "Role-based access control for Human-in-the-Loop (HITL) checkpoints",
      "enforcement_level": "strict",
      "roles": [
        {
          "role_id": "reviewer",
          "role_name": "Claims Reviewer",
          "allowed_checkpoint_types": ["approval", "input"],
          "allowed_workflows": ["claims_triage"],
          "permissions": ["view", "approve", "reject", "add_comments"]
        },
        {
          "role_id": "fraud_investigator",
          "role_name": "Fraud Investigator",
          "allowed_checkpoint_types": ["decision", "escalation"],
          "allowed_workflows": ["claims_triage"],
          "permissions": ["view", "decide", "escalate", "request_more_info"]
        },
        {
          "role_id": "claims_adjuster",
          "role_name": "Claims Adjuster",
          "allowed_checkpoint_types": ["input", "approval"],
          "allowed_workflows": ["claims_triage"],
          "permissions": ["view", "approve", "reject", "edit_data", "add_comments"]
        },
        {
          "role_id": "approver",
          "role_name": "Senior Approver",
          "allowed_checkpoint_types": ["approval", "decision"],
          "allowed_workflows": ["*"],
          "permissions": ["view", "approve", "reject", "request_revision", "escalate"]
        },
        {
          "role_id": "admin",
          "role_name": "System Administrator",
          "allowed_checkpoint_types": ["*"],
          "allowed_workflows": ["*"],
          "permissions": ["*"]
        }
      ],
      "checkpoint_timeout_limits": {
        "min_timeout_seconds": 300,
        "max_timeout_seconds": 86400,
        "default_timeout_seconds": 3600
      }
    },
    "context_governance": {
      "description": "Controls context engineering behaviors, limits, and auditing",
      "enforcement_level": "strict",
      "max_context_tokens_per_agent": 10000,
      "max_memory_retrievals_per_invocation": 10,
      "max_artifact_loads_per_invocation": 5,
      "compaction_approval_required": false,
      "allow_llm_summarization": true,
      "context_auditing": {
        "log_all_compilations": true,
        "log_truncations": true,
        "log_compactions": true,
        "_description": "Comprehensive logging of context engineering decisions for governance and debugging"
      },
      "_description": "Governance policies for context engineering features including token limits, memory/artifact access, and auditing requirements"
    },
    "multi_agent_handoffs": {
      "description": "Controls context handoff patterns between agents for scoped context sharing",
      "enforcement_level": "strict",
      "default_handoff_mode": "scoped",
      "enable_conversation_translation": true,
      "audit_all_handoffs": true,
      "agent_handoff_rules": [
        {
          "from_agent_id": "fraud_agent",
          "to_agent_id": "recommendation_agent",
          "handoff_mode": "scoped",
          "allowed_context_fields": [
            "fraud_score",
            "fraud_indicators",
            "risk_level",
            "fraud_explanation"
          ],
          "conversation_translation": {
            "enabled": true,
            "summarize": false,
            "filter_enabled": true
          },
          "rule_id": "fraud_to_recommendation",
          "_description": "Fraud agent can pass only fraud-related fields to recommendation agent"
        },
        {
          "from_agent_id": "coverage_agent",
          "to_agent_id": "severity_agent",
          "handoff_mode": "scoped",
          "allowed_context_fields": [
            "coverage_determination",
            "policy_limits",
            "coverage_amount",
            "covered_perils"
          ],
          "conversation_translation": {
            "enabled": true,
            "summarize": false,
            "filter_enabled": true
          },
          "rule_id": "coverage_to_severity",
          "_description": "Coverage agent passes only coverage-related fields to severity agent"
        },
        {
          "from_agent_id": "intake_agent",
          "to_agent_id": "*",
          "handoff_mode": "full",
          "conversation_translation": {
            "enabled": false
          },
          "rule_id": "intake_to_all",
          "_description": "Intake agent output is safe to share widely - full context mode"
        },
        {
          "from_agent_id": "severity_agent",
          "to_agent_id": "recommendation_agent",
          "handoff_mode": "scoped",
          "allowed_context_fields": [
            "severity_classification",
            "complexity_score",
            "estimated_cost"
          ],
          "blocked_context_fields": [
            "internal_notes",
            "complexity_analysis_details"
          ],
          "conversation_translation": {
            "enabled": true,
            "summarize": true,
            "max_summary_tokens": 500
          },
          "rule_id": "severity_to_recommendation",
          "_description": "Severity agent passes classification only, summarizes verbose analysis"
        },
        {
          "from_agent_id": "*",
          "to_agent_id": "explainability_agent",
          "handoff_mode": "full",
          "conversation_translation": {
            "enabled": false
          },
          "rule_id": "all_to_explainability",
          "_description": "Explainability agent needs full context to generate comprehensive explanations"
        }
      ],
      "_description": "Defines scoped context handoff rules between agents. Handoff modes: 'full' (all context), 'scoped' (selected fields), 'minimal' (no history). Supports conversation translation and field-level filtering."
    },
    "context_filtering": {
      "description": "Deterministic pre-LLM filtering rules for context data",
      "enforcement_level": "strict",
      "enabled": false,
      "rules": [
        {
          "rule_id": "filter_old_observations",
          "description": "Remove observations older than 30 days",
          "enabled": true,
          "field": "observations",
          "condition": {
            "type": "age_threshold",
            "max_age_days": 30
          }
        },
        {
          "rule_id": "mask_ssn",
          "description": "Mask Social Security Numbers for PII protection",
          "enabled": true,
          "field": "original_input",
          "condition": {
            "type": "regex_mask",
            "patterns": [
              {
                "pattern": "\\d{3}-\\d{2}-\\d{4}",
                "replacement": "***-**-****",
                "description": "SSN format XXX-XX-XXXX"
              },
              {
                "pattern": "\\d{9}",
                "replacement": "*********",
                "description": "SSN format XXXXXXXXX (no dashes)"
              }
            ]
          }
        },
        {
          "rule_id": "mask_credit_cards",
          "description": "Mask credit card numbers for PII protection",
          "enabled": true,
          "field": "original_input",
          "condition": {
            "type": "regex_mask",
            "patterns": [
              {
                "pattern": "\\d{4}[- ]?\\d{4}[- ]?\\d{4}[- ]?\\d{4}",
                "replacement": "****-****-****-****",
                "description": "Credit card format"
              }
            ]
          }
        },
        {
          "rule_id": "remove_debug_logs",
          "description": "Filter out debug-level log observations",
          "enabled": false,
          "field": "observations",
          "condition": {
            "type": "field_value_match",
            "match_field": "log_level",
            "match_value": "debug"
          }
        }
      ],
      "_description": "Phase 8: Deterministic filtering rules applied before LLM sees context. Supports age-based filtering, regex masking (PII protection), and field matching. All filtering decisions are logged for audit."
    }
  }
}
